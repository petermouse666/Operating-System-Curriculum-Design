# Operating-System-Curriculum-Design
2023年春华中科技大学网络空间安全学院操作系统课设  
(感谢tls、lls带飞Orz，我等鼠辈完全是对二位代码与思路的拙劣模仿QAQ)  

## 一、课设题目
    启动保护模式，建立两个或更多具有不同优先级的任务（每个任务不停循环地在屏幕上输出字符串），所有任务在时钟驱动（时钟周期50ms，可调）下进行切换。任务切换采用“优先数进程调度策略”。示例，四个任务（优先级分别为16,10,8,6）各自输出：VERY LOVE HUST MRSU字符串，每个字符串的持续显示时间长度有差异（体现了优先级的差异）。  
    1.内容 1 （ ≤ 70 分）:实现保护模式初始化程序，能将CPU带入保护模式，实现不同权限级别的代码跳转。在屏幕输出相应的字符串指示程序工作情况状态。代码至少含有GDT,LDT,TSS,门等概念。  
    2.内容 2 （ ≤ 80 分）:定义2个任务A和B（两套页目录和页表），实现任务A切换到任务B。任务A和B都不是死循环，A先运行，然后切换到B（此后不切换）。任务A和B的功能代码（即输出字符串的代码）都是用户态。线性地址与物理地址可采用一一对应关系，特定地址自行映射。  
    3.内容 3 （ ≤ 95 分）:2个任务A和B在时钟中断服务程序中实现A和B轮流切换。任务A和B都是死循环。时钟中断服务程序（切换任务）。  
    4.内容 4 （ ≤ 100 分）:定义多个任务，每个任务的优先数不同，在时钟中断服务程序中，采用“优先数调度算法”实现多个任务的切换。每个任务都是死循环，循环输出字符串。每个任务字符显示时长与优先级一致（优先数大，运行机会多，显示时长就大）。时钟中断服务程序（选择任务，切换任务）。  
    （参考书籍：《Orange'S:一个操作系统的实现》，老书了，涉及版权问题不放电子版，大家各显神通吧0.0）  
    
## 二、项目文件内容：  
  a.asm 主体代码  
  a.com 主体代码编译产物  
  pm.inc && lib.inc 运行时要用到的库，包含若干预定义函数与宏等  
  auto.sh 代码编译+运行脚本  
  b.img && c.img && code.img && freedos.img 预先生成的镜像文件  
  bochsrc 配置文件  

## 三、使用方法或注意事项：  
  1.bochs建议使用源码安装，否则可能无法使用调试功能，为后续debug带来麻烦。  
  2.bochsrc中romimage与vgaromimage应改为自己电脑上bochs源码安装的相应位置，如将bochs-2.6.11就放在桌面上编译安装了，那么此处的路径就应为：  
  romimage: file=/home/XXX/桌面/bochs-2.6.11/bios/BIOS-bochs-latest  
  vgaromimage: file=/home/XXX/桌面/bochs-2.6.11/bios/VGABIOS-lgpl-latest  
  3.magic_break选项用于debug。当enabled=1时，表明可以进行调试，在代码中加入“xchg bx,bx”语句就可以在相应位置停下，再用c,n,r等指令进行debug。  
  4.运行脚本纯粹是图省事，把若干命令行集成在一块了。如果更改文件名后使用脚本运行，需要修改脚本内容中的文件名，具体的不再解释了，相信这么简单的一个玩意应该都能看得懂。脚本运行需要管理员权限。  
  5.First Commit的a.asm算是有点阉割版，因为没有完全实现优先数调度，就按照顺序依次执行四个任务，所以应该不够100罢，但95应该是enough了。（其实按分工该我完成这块的，但是我确实是懒得写了，直接开摆，懂不懂被tls带飞的感觉啊，乐^_^）  
